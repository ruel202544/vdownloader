<script>
  const downloadBtn = document.getElementById('downloadBtn');
  const progressBar = document.querySelector('#progressBar div');
  const status = document.getElementById('status');

  downloadBtn.addEventListener('click', async () => {
    const url = document.getElementById('videoUrl').value;
    if (!url) return alert('Please enter a YouTube URL.');

    status.textContent = 'Starting download...';
    progressBar.style.width = '0%';

    // Listen for live progress (optional)
    const evtSource = new EventSource('/progress'); // relative URL
    evtSource.onmessage = (event) => {
      const percent = event.data;
      progressBar.style.width = percent + '%';
      if (percent >= 100) {
        status.textContent = 'Download complete!';
        evtSource.close();
      } else {
        status.textContent = 'Downloading... ' + percent + '%';
      }
    };

    // Send download request to the backend
    await fetch('/api/download', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ url })
    });
  });
</script>
